# Инструкция по исправлению ошибок

Для исправления всех проблем с экспортом в Excel и функцией "Поделиться" выполните следующие шаги:

## 1. Запустите скрипт исправления базы данных

Откройте в браузере: `http://aplana-0.ru/fix_database.php`

Этот скрипт:
- Проверит структуру таблицы orders
- Добавит отсутствующие столбцы (product_name и order_date)
- Заполнит эти столбцы данными для существующих записей

## 2. Обновите файлы

На хостинге необходимо заменить содержимое следующих файлов:

1. `utils/ExcelExport.php` - Исправляет ошибки с заголовками
2. `pages/stats.php` - Исправляет кнопку экспорта
3. `pages/share_analytics.php` - Исправляет функцию "Поделиться"

## 3. Проверьте работу системы

1. Откройте раздел "Статистика" (`/pages/stats.php`)
2. Нажмите кнопку "Экспорт" - должен начаться скачиваться Excel-файл
3. Откройте раздел "Аналитика" (`/pages/analytics.php`)
4. Нажмите кнопку "Поделиться" и выберите один из методов шаринга

## Технические детали

Основные исправления:
1. Добавлены недостающие поля в таблицу orders: `product_name` и `order_date` 
2. Устранены ошибки с установкой заголовков в ExcelExport.php
3. Исправлены SQL-запросы, которые ссылались на несуществующие поля
4. Добавлена корректная обработка ошибок при отсутствии полей
5. Исправлен JavaScript для обработки функции "Поделиться"

## Примечание

В случае, если не все ошибки будут устранены, можно добавить обработку исключений в файлы:
- `pages/export_orders.php`
- `pages/export_statistics.php`
- `pages/export_clients.php`

Для этого добавьте конструкцию try-catch вокруг основного кода в этих файлах. 